<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ASCEND SUPPORT FORM</title>
    <link rel="icon" href="image/ascend.gif" type="image/gif">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="stlye.css">
</head>

<body>

<h1>ASCEND APPLICATION FORM</h1>

<div class="logo-box">
    <img src="image/ascend.gif" alt="Ascend Logo">
    <hr>
</div>

<form id="Customer">

    <table border="1">

        <tr>
            <th colspan="2">ASCEND PURCHASE FORM</th>
        </tr>

        <tr>
            <td>IC NAME</td>
            <td><input type="text" name="pname" placeholder="ENTER YOUR NAME" required></td>
        </tr>

        <tr>
            <td>DISCORD NAME</td>
            <td><input type="text" name="dname" placeholder="ENTER YOUR DISCORD NAME" required></td>
        </tr>

        <tr>
            <td>UID</td>
            <td><input type="text" name="uid" placeholder="ENTER YOUR UID" required></td>
        </tr>

        <tr>
            <td>SELECTED PACK / VEHICLE</td>
            <td><input type="text" id="selectedPack" name="selectedPack" readonly></td>
        </tr>

        <tr>
            <td>AMOUNT</td>
            <td><input type="text" id="amountField" name="amount" readonly></td>
        </tr>

        <tr>
            <td>PAYMENT PROOF</td>
            <td><input type="file" name="paymentProof" accept="image/*,.pdf" required></td>
        </tr>

    </table>

    <!-- PAYMENT SECTION -->
    <div id="paymentSection" style="text-align:center; margin-top:30px; padding:20px; background:rgba(0,247,255,0.1); border-radius:12px; border:1px solid rgba(0,247,255,0.3);">
        <h3 style="color:#00f7ff; margin-bottom:15px;">üí≥ PAYMENT DETAILS</h3>
        
        <div style="margin:15px 0;">
            <p style="font-size:0.9rem; color:#fff; margin-bottom:10px;"><strong>UPI ID:</strong> <code style="background:#1c1c1c; padding:5px 10px; border-radius:5px; color:#ffd700;">gajaraj1628@okhdfcbank</code></p>
            <p style="font-size:0.9rem; color:#ff00ff;"><strong>Select Payment App & Pay:</strong></p>
        </div>

        <div id="paymentApps" style="display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin:15px 0;">
            <button type="button" onclick="openPaymentApp('pay')" class="payment-btn" title="Open Payment">
                <span style="font-size:1.2rem;">üí≥</span> Pay Now
            </button>
        </div>

        <p style="font-size:0.85rem; color:#ccc; margin-top:10px;">After payment, upload receipt below and submit form</p>
    </div>

    <div style="text-align:center; margin-top:20px;">
        <input type="submit" value="Submit">
        <input type="reset" value="Clear">
    </div>

</form>

<!-- SCRIPT SECTION -->

<script>
// UPI PAYMENT CONFIGURATION
const UPI_ID = "gajaraj1628@okhdfcbank";
const MERCHANT_NAME = "ASCEND SERVER";

// Detect if mobile device
function isMobileDevice() {
    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
}

// Generate Payment Link for Website
function generatePaymentLink(amount) {
    const amountValue = amount.replace('‚Çπ', '').trim();
    const transactionRef = 'ASCEND-' + Date.now();
    
    // Standard UPI payment link (works on web browsers)
    const paymentLink = `upi://pay?pa=${UPI_ID}&pn=${encodeURIComponent(MERCHANT_NAME)}&am=${amountValue}&tr=${transactionRef}`;
    
    return paymentLink;
}

// Show Payment Link
function openPaymentApp(appName) {
    const amountField = document.getElementById("amountField").value;
    const selectedPack = document.getElementById("selectedPack").value;
    
    if (!amountField || !selectedPack) {
        alert("‚ùå Please select a pack first before proceeding to payment!");
        return;
    }

    const amount = amountField.replace('‚Çπ', '').trim();
    const paymentLink = generatePaymentLink(amountField);
    
    // Open payment link in new window/tab
    window.location.href = paymentLink;
}

// Initialize payment section visibility
function initPaymentSection() {
    const paymentSection = document.getElementById("paymentSection");
    const amountField = document.getElementById("amountField");
    
    // Update payment section when amount changes
    const observer = new MutationObserver(() => {
        if (amountField.value) {
            paymentSection.style.display = "block";
        }
    });
    
    observer.observe(amountField, { attributes: true });
    
    // Check initial state
    if (!amountField.value) {
        paymentSection.style.display = "none";
    }
}

document.addEventListener("DOMContentLoaded", function () {

    // Get data from URL
    const urlParams = new URLSearchParams(window.location.search);
    const vehicle = urlParams.get("vehicle");
    const pack = urlParams.get("pack");
    const price = urlParams.get("price");

    if (vehicle) {
        document.getElementById("selectedPack").value = vehicle;
    }

    if (pack) {
        document.getElementById("selectedPack").value = pack;
    }

    if (price) {
        document.getElementById("amountField").value = "‚Çπ" + price;
    }

    // Initialize payment section
    initPaymentSection();

});


// DISCORD WEBHOOK SUBMIT

document.getElementById("Customer").addEventListener("submit", function(e) {
    e.preventDefault();

    const pname = document.querySelector("[name='pname']").value;
    const dname = document.querySelector("[name='dname']").value;
    const uid = document.querySelector("[name='uid']").value;
    const pack = document.getElementById("selectedPack").value;
    const amount = document.getElementById("amountField").value;
    const paymentProofFile = document.querySelector("[name='paymentProof']").files[0];

    const webhookURL = "https://discord.com/api/webhooks/1469751200604881039/KAQFQHeeCiGgpaCZlduoq1vAPRiWZ6FxrI3FGPGtiln7d5KC9gL40ARADuoRhpZhQ1Dc"; // üî¥ PASTE YOUR WEBHOOK HERE

    const data = {
        embeds: [{
            content: "<@&1461606860372316377> <@&1461606866810437702>",
            title: "üõí ASCEND PURCHASE",
            color: 16711935,
            fields: [
                { name: "IC Name", value: pname, inline: true },
                { name: "Discord Name", value: dname, inline: true },
                { name: "UID", value: uid, inline: false },
                { name: "Pack / Vehicle", value: pack || "Not Provided", inline: true },
                { name: "Amount", value: amount || "Not Provided", inline: true },
                { name: "Payment Method", value: "UPI - ASCEND SERVER", inline: true },
                { name: "Payment Proof", value: paymentProofFile ? paymentProofFile.name : "Not Provided", inline: false }
            ],
            footer: {
                text: "ASCEND SYSTEM"
            },
            timestamp: new Date()
        }]
    };

    const formData = new FormData();
    formData.append('payload_json', JSON.stringify(data));
    if (paymentProofFile) {
        formData.append('file', paymentProofFile);
    }

    fetch(webhookURL, {
        method: "POST",
        body: formData
    })
    .then(response => {
        if (response.ok) {
            alert("‚úÖ Application Submitted Successfully!\n\nThank you for your purchase!");
            document.getElementById("Customer").reset();
            document.getElementById("paymentSection").style.display = "none";
        } else {
            alert("‚ùå Error sending to Discord.");
        }
    })
    .catch(error => {
        alert("‚ùå Webhook error.");
    });

});
</script>

</body>
</html>
